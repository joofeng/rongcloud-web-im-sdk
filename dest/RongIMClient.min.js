!function(e){function t(s){if(n[s])return n[s].exports;var r=n[s]={exports:{},id:s,loaded:!1};return e[s].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){(function(e){var t=n(5),s=n(1),r=n(2);n(29),n(16),n(17),n(15),t.version="0.9.10",t.connect=function(n,s){if(!t.getInstance)throw new Error("please init");e.Modules?t.getInstance().connect(n,s):(t.connect.token=n,t.connect.callback=s)},t.hasUnreadMessages=function(e,n,r){s.jsonp("http://api.cn.rong.io/message/exist.js?appKey="+encodeURIComponent(e)+"&token="+encodeURIComponent(n),"callBack",function(e){r.onSuccess(!!+e.status)},function(){r.onError(t.callback.ErrorCode.UNKNOWN_ERROR)})},t.init=function(e){var n=null;void 0===t.getInstance&&(t.getInstance=function(){return null==n&&(n=new t(e)),n})},t.registerMessageType=function(e){if(!t.getInstance)throw new Error("unInitException");if(!("messageType"in e&&"objectName"in e&&"fieldName"in e))throw new Error("registerMessageType:arguments type is error");r.registerMessageTypeMapping[e.objectName]=e.messageType;var n=t[e.messageType]=function(n){t.RongIMMessage.call(this,n),t.MessageType[e.messageType]=e.messageType,this.setMessageType(e.messageType),this.setObjectName(e.objectName);for(var s=0;s<e.fieldName.length;s++){var r=e.fieldName[s];this["set"+r]=function(e){return function(t){this.setContent(t,e)}}(r),this["get"+r]=function(e){return function(){return this.getDetail()[e]}}(r)}};s.inherit(n,t.RongIMMessage,!0)},t.setConnectionStatusListener=function(e){if(!t.getInstance)throw new Error("unInitException");t.getInstance().setConnectionStatusListener(e)},window.RongIMClient=t}).call(t,function(){return this}())},function(module,exports,__webpack_require__){var mapping=__webpack_require__(2),doc=document,global=window,transportType="",tool={load:function(e){return"complete"==doc.readyState||this._pageLoaded?e():void(global.attachEvent?global.attachEvent("onload",e):global.addEventListener("load",e,!1))},inherit:function(e,t,n){var s=function(){};n?s.prototype=new t:s.prototype=t.prototype,e.super_=t,e.prototype=new s,e.prototype.constructor=e},indexOf:function(e,t,n){for(var s=e.length,r=0>n?Math.max(0,+n):n||0;s>r;r++)if(e[r]==t)return r;return-1},isArray:function(e){return"[object Array]"==Object.prototype.toString.call(e)},forEach:function(){return[].forEach?function(e,t){[].forEach.call(e,t)}:function(e,t){for(var n=0;n<e.length;n++)t.call(e,e[n],n,e)}}(),each:function(e,t){if(this.isArray(e))this.forEach(x,t);else for(var n in e)e.hasOwnProperty(n)&&t.call(e,n,e[n])},merge:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},arrayFrom:function(e){if("[object ArrayBuffer]"==Object.prototype.toString.call(e)){var t=new Int8Array(e);return[].slice.call(t)}return e},remove:function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e.splice(n,1)[0];return null},int64ToTimestamp:function(e,t){if(void 0===e.low)return e;var n=e.low;0>n&&(n+=4294967296),n=n.toString(16);var s=parseInt(e.high.toString(16)+"00000000".replace(new RegExp("0{"+n.length+"}$"),n),16);return t?new Date(s):s},getType:function(e){return Object.prototype.toString.call(e).slice(8,-1)},ready:function(e){"interactive"==doc.readyState||"complete"==doc.readyState?e():doc.addEventListener?doc.addEventListener("DOMContentLoaded",function(){doc.removeEventListener("DOMContentLoaded",arguments.callee,!1),e()},!1):doc.attachEvent&&doc.attachEvent("onreadystatechange",function(){("interactive"===doc.readyState||"complete"===doc.readyState)&&(doc.detachEvent("onreadystatechange",arguments.callee),e())})},loadScript:function(e,t){var n=doc.createElement("script"),s=doc.body||doc.getElementsByTagName("body")[0];n.src=e,s.appendChild(n),"onload"in n?n.onload=function(){t&&t()}:n.onreadystatechange=function(){"complete"===n.readyState&&t&&t()}},jsonp:function(e,t,n,s){var r="cb"+jsonpCount++,o="window.RongIMClient.jsonpPool."+r;void 0===global.RongIMClient.jsonpPool&&(global.RongIMClient.jsonpPool={}),global.RongIMClient.jsonpPool[r]=function(e){try{n(e)}finally{delete global.RongIMClient.jsonpPool[r],i.parentNode.removeChild(i)}};var i=doc.createElement("script");i.src=e+"&"+t+"="+o,i.onerror=function(){s()},doc.body.appendChild(i)},getTransportType:function(){return transportType},setTransportType:function(e){transportType=e},ios:/iphone|ipad/i.test(navigator.userAgent),android:/android/i.test(navigator.userAgent),_pageLoaded:!1},jsonpCount=1;tool.cookieHelper=function(){var e,t;return mapping.globalConf.FORCE_LOCAL_STORAGE===!0?(t=localStorage.setItem,localStorage.setItem=function(e,n){15==localStorage.length&&localStorage.removeItem(localStorage.key(0)),t.call(localStorage,e,n)},e=localStorage):e={getItem:function(e){var t=doc.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=t?t[2]:null},setItem:function(e,t){var n=new Date;n.setTime(n.getTime()+1296e6),doc.cookie=e+"="+escape(t)+";path=/;expires="+n.toGMTString()},removeItem:function(e){this.getItem(e)&&(doc.cookie=e+"=;path=/;expires=Thu, 01-Jan-1970 00:00:01 GMT")},clear:function(){var e=doc.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var t=e.length;t--;)doc.cookie=e[t]+"=0;path=/;expires="+new Date(0).toUTCString()}},e}(),tool.load(function(){tool._pageLoaded=!0,global.JSON?tool.JSON=global.JSON:tool.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(){var e=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===e.call(t)},n={'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},s=function(e){return n[e]||"\\u"+(e.charCodeAt(0)+65536).toString(16).substr(1)},r=new RegExp('[\\"'+unescape("%00-%1F%u2028%u2029")+"]","g");return function o(n){if(null==n)return"null";if("number"==typeof n)return isFinite(n)?n.toString():"null";if("boolean"==typeof n)return n.toString();if("object"==typeof n){if("function"==typeof n.toJSON)return o(n.toJSON());if(t(n)){for(var i="[",a=0;a<n.length;a++)i+=(a?", ":"")+o(n[a]);return i+"]"}if("[object Object]"===e.call(n)){var c=[];for(var u in n)n.hasOwnProperty(u)&&c.push(o(u)+": "+o(n[u]));return"{"+c.join(", ")+"}"}}return'"'+n.toString().replace(r,s)+'"'}}()},tool.messageIdHandler=function(){var e=0,t="xhr-polling"===tool.getTransportType(),n=function(){e=+(tool.cookieHelper.getItem("msgId")||tool.cookieHelper.setItem("msgId",0)||0)};return t&&n(),{messageIdPlus:function(s){return t&&n(),e>=65535?(s(),!1):(e++,t&&tool.cookieHelper.setItem("msgId",e),e)},clearMessageId:function(){e=0,t&&tool.cookieHelper.setItem("msgId",e)},getMessageId:function(){return t&&n(),e}}}()}),module.exports=tool},function(e,t){e.exports={mapping:{1:4,2:2,3:3,4:0,5:1,6:5},typeMapping:{"RC:TxtMsg":"TextMessage","RC:ImgMsg":"ImageMessage","RC:VcMsg":"VoiceMessage","RC:ImgTextMsg":"RichContentMessage","RC:LBSMsg":"LocationMessage"},sysNtf:{"RC:InfoNtf":"InformationNotificationMessage","RC:ContactNtf":"ContactNotificationMessage","RC:ProfileNtf":"ProfileNotificationMessage","RC:CmdNtf":"CommandNotificationMessage","RC:DizNtf":"DiscussionNotificationMessage"},_ReceiveMessageListener:null,_ConnectionStatusListener:null,registerMessageTypeMapping:{},userInfoMapping:{},topic:["invtDiz","crDiz","qnUrl","userInf","dizInf","userInf","joinGrp","quitDiz","exitGrp","evctDiz",["chatMsg","pcMsgP","pdMsgP","pgMsgP","ppMsgP"],"pdOpen","rename","uGcmpr","qnTkn","destroyChrm","createChrm","exitChrm","queryChrm","joinChrm","pGrps","addBlack","rmBlack","getBlack","blackStat","addRelation","qryRelation","delRelation"],globalConf:{WEB_SOCKET_FORCE_FLASH:null,WEB_XHR_POLLING:null,FORCE_LOCAL_STORAGE:null},Endpoint:{},userId:"",reconnectSet:{},chatroomId:""}},function(e,t){function n(e,t,n){for(var s=n?n:[],r=0;t>r;r++)s[r]=e.pool[e.position++];return s}function s(e){if(!(this instanceof s))return new s(e);if(this.pool=[],"[object Array]"===Object.prototype.toString.call(e))this.pool=o.init(e);else if("[object ArrayBuffer]"==Object.prototype.toString.call(e)){var t=new Int8Array(e);this.pool=o.init([].slice.call(t))}else"string"==typeof e&&(this.pool=o.writeUTF(e));var n=this;this.position=0,this.writen=0,this.check=function(){return n.position>=n.pool.length}}var r=window,o=r.RongBinaryHelper={init:function(e){for(var t=0;t<e.length;t++)if(e[t]*=1,e[t]<0&&(e[t]+=256),e[t]>255)throw new Error("不合法字节流");return e},writeUTF:function(e,t){for(var n=[],s=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);o>=0&&127>=o?(s+=1,n.push(o)):o>=128&&2047>=o?(s+=2,n.push(192|31&o>>6),n.push(128|63&o)):o>=2048&&65535>=o&&(s+=3,n.push(224|15&o>>12),n.push(128|63&o>>6),n.push(128|63&o))}for(r=0;r<n.length;r++)n[r]>255&&(n[r]&=255);return t?n:255>=s?[0,s].concat(n):[s>>8,255&s].concat(n)},readUTF:function(e){if("[object String]"==Object.prototype.toString.call(e))return e;for(var t="",n=this.init(e),s=0;s<n.length;s++){var r=n[s].toString(2),o=r.match(/^1+?(?=0)/);if(o&&8==r.length){for(var i=o[0].length,a=n[s].toString(2).slice(7-i),c=1;i>c;c++)a+=n[c+s].toString(2).slice(2);t+=String.fromCharCode(parseInt(a,2)),s+=i-1}else t+=String.fromCharCode(n[s])}return t},convertStream:function(e){return e instanceof s?e:new s(e)},toMQttString:function(e){return this.writeUTF(e)}},i=function(){return!!window.ArrayBuffer}();s.parse=function(e){return o.convertStream(e)},s.toMQTString=function(e){return o.toMQttString(e)},s.prototype={readInt:function(){if(this.check())return-1;for(var e="",t=0;4>t;t++)e+=this.pool[this.position++].toString(16);return parseInt(e,16)},readByte:function(){if(this.check())return-1;var e=this.pool[this.position++];return e>255&&(e&=255),e},read:function(e){return this.check()?-1:e?n(this,0|e.length,e):this.readByte()},readUTF:function(){var e=this.readByte()<<8|this.readByte();return o.readUTF(this.pool.slice(this.position,this.position+=e))},write:function(e){var t=e;return"[object array]"==Object.prototype.toString.call(t).toLowerCase()?([].push.apply(this.pool,t),this.writen+=t.length):+t==t&&(t>255&&(t&=255),this.pool.push(t),this.writen++),t},writeChar:function(e){if(+e!=e)throw new Error("writeChar:arguments type is error");this.write(e>>8&255),this.write(255&e),this.writen+=2},writeUTF:function(e){var t=o.writeUTF(e);[].push.apply(this.pool,t),this.writen+=t.length},toComplements:function(){for(var e=this.pool,t=0;t<e.length;t++)e[t]>128&&(e[t]-=256);return e},getBytesArray:function(e){return e?this.toComplements():this.pool},toArrayBuffer:function(){if(i)return new ArrayBuffer(this.getBytesArray());throw new Error("not support arraybuffer")},clear:function(){this.pool=[],this.writen=this.position=0}},e.exports=s},function(e,t,n){var s=n(6),r=s({AT_MOST_ONCE:0,AT_LEAST_ONCE:1,EXACTLY_ONCE:2,DEFAULT:3}),o=s({CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,QUERY:5,QUERYACK:6,QUERYCON:7,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14}),i=s({RECONNECT:0,OTHER_DEVICE_LOGIN:1,CLOSURE:2,UNKNOWN_ERROR:3,LOGOUT:4,BLOCK:5}),a=s({ACCEPTED:0,UNACCEPTABLE_PROTOCOL_VERSION:1,IDENTIFIER_REJECTED:2,SERVER_UNAVAILABLE:3,TOKEN_INCORRECT:4,NOT_AUTHORIZED:5,REDIRECT:6,PACKAGE_ERROR:7,APP_BLOCK_OR_DELETE:8,BLOCK:9,TOKEN_EXPIRE:10,DEVICE_ERROR:11});e.exports={Qos:r,Type:o,DisconnectionStatus:i,ConnectionState:a}},function(e,t,n){function s(e){this.appkey=e,p=this}var r=n(1),o=n(18),i=n(21),a=n(2),c=n(11),u=[],g=new o.list,h=o.sessionStore,f=null,p=null,l=o.C2S,d=o.LimitableMap,M={4:"qryPMsg",1:"qryCMsg",3:"qryGMsg",2:"qryDMsg",5:"qrySMsg"},y=new d;s.prototype.clearTextMessageDraft=function(e,t){return h.removeItem(e+"_"+t)},s.prototype.getTextMessageDraft=function(e,t){return h.getItem(e+"_"+t)},s.prototype.saveTextMessageDraft=function(e,t,n){return h.setItem(e+"_"+t,n)},s.prototype.getIO=function(){return f.context.channel},s.prototype.connect=function(e,t){f=new i(this.appkey,e,t);for(var n=0;n<u.length;n++)f.setListener(u[n]);u=[]},s.prototype.disconnect=function(){f&&f.disConnect()},s.prototype.reconnect=function(e){f&&f.reConnect(e)},s.prototype.syncConversationList=function(e){var t=new Modules.RelationsInput;t.setType(1),f.queryMsg(26,r.arrayFrom(t.toArrayBuffer()),a.userId,{onSuccess:function(t){r.forEach(t.info,function(e){var t=p.createConversation(s.ConversationType.setValue(a.mapping[e.type]),e.userId,"",!0);1==e.type&&p.getUserInfo(e.userId,{onSuccess:function(e){e.getUserName&&(t.setConversationTitle(e.getUserName()),t.setConversationPortrait(e.getPortraitUri()))},onError:function(){}})}),e.onSuccess()},onError:function(){e.onError(s.callback.ErrorCode.UNKNOWN_ERROR)}},"RelationsOutput")},s.prototype.getConversation=function(e,t){return this.getConversationList().get(e,t)},s.prototype.getConversationList=function(){return g},s.prototype.getConversationNotificationStatus=function(e,t,n){var r=this.getConversation(e,t);r?n.onSuccess(r.getNotificationStatus()):n.onError(s.callback.ErrorCode.UNKNOWN_ERROR)},s.prototype.clearConversations=function(e){for(var t=[],n=0;n<e.length;n++)for(var s=0;s<g.length;s++)g[s].getConversationType()==e[n]&&t.push(s);for(n=0;n<t.length;n++){var r=g[t[n]-n];this.removeConversation(r.getConversationType(),r.getTargetId())}},s.prototype.getGroupConversationList=function(){for(var e,t=[],n=0;e=this.getConversationList()[n++];)3==e.getConversationType()&&t.push(e);return t},s.prototype.removeConversation=function(e,t){var n=r.remove(this.getConversationList(),function(n){return n.getTargetId()==t&&n.getConversationType()==e});if(n){var s=new Modules.RelationInfo;s.setType(l[e.valueOf()]),s.setUserId(t),f.queryMsg(27,r.arrayFrom(s.toArrayBuffer()),t,{onSuccess:function(){},onError:function(){}})}},s.prototype.setConversationNotificationStatus=function(e,t,n,r){var o=this.getConversation(e,t);o?(o.setNotificationStatus(n),r.onSuccess(n)):r.onError(s.callback.ErrorCode.UNKNOWN_ERROR)},s.prototype.setConversationToTop=function(e,t){this.getConversation(e,t).setTop()},s.prototype.setConversationName=function(e,t,n){this.getConversation(e,t).setConversationTitle(n)},s.prototype.createConversation=function(e,t,n,o){var i=this.getConversationList().get(e,t);if(i)return i;var a=new s.Conversation;if(a.setTargetId(t),a.setConversationType(e),a.setConversationTitle(n),a.setTop(),/^[1234]$/.test(e.valueOf())&&!o){var c=new Modules.RelationsInput;c.setType(l[e.valueOf()]),f.queryMsg(25,r.arrayFrom(c.toArrayBuffer()),t,{onSuccess:function(){},onError:function(){}})}return a},s.prototype.getCurrentUserInfo=function(e){this.getUserInfo(a.userId,e)},s.prototype.getUserInfo=function(e,t){var n=new Modules.GetUserInfoInput;n.setNothing(1),f.queryMsg(5,r.arrayFrom(n.toArrayBuffer()),e,t,"GetUserInfoOutput")},s.prototype.sendMessage=function(e,t,n,r,o){if(!f.context.channel.isWritable()||5==e)return void o.onError(s.callback.ErrorCode.UNKNOWN_ERROR);n instanceof s.MessageContent||(n=new s.MessageContent(n)),r&&r.process(n.getMessage());var i,c=n.encode(),u=n.getMessage();u.setConversationType(e),u.setMessageDirection(s.MessageDirection.SEND),u.getMessageId()||u.setMessageId(e+"_"+~~(16777215*Math.random())),u.setSentStatus(s.SentStatus.SENDING),u.setSenderUserId(a.userId),u.setSentTime((new Date).getTime()),u.setTargetId(t),/ISCOUNTED/.test(u.getMessageTag())&&(i=this.getConversationList().get(e,t),i||(i=this.createConversation(e,t,"")),i.setSentTime((new Date).getTime()),i.setSentStatus(s.SentStatus.SENDING),i.setSenderUserName(""),i.setSenderUserId(a.userId),i.setObjectName(u.getObjectName()),i.setNotificationStatus(s.ConversationNotificationStatus.DO_NOT_DISTURB),i.setLatestMessageId(u.getMessageId()),i.setLatestMessage(n.getMessage()),i.setUnreadMessageCount(0),i.setTop()),f.pubMsg(e.valueOf(),c,t,o,u)},s.prototype.uploadMedia=function(e,t,n,s){},s.prototype.getUploadToken=function(e){var t=new Modules.GetQNupTokenInput;t.setType(1),f.queryMsg(14,r.arrayFrom(t.toArrayBuffer()),a.userId,e,"GetQNupTokenOutput")},s.prototype.getDownloadUrl=function(e,t){var n=new Modules.GetQNdownloadUrlInput;n.setType(1),n.setKey(e),f.queryMsg(14,r.arrayFrom(n.toArrayBuffer()),a.userId,t,"GetQNdownloadUrlOutput")},s.prototype.setConnectionStatusListener=function(e){f?f.setListener(e):u.push(e)},s.prototype.setOnReceiveMessageListener=function(e){f?f.setListener(e):u.push(e)},s.prototype.getTotalUnreadCount=function(){var e=0;return r.forEach(this.getConversationList(),function(t){e+=t.getUnreadMessageCount()}),e},s.prototype.getUnreadCount=function(e,t){var n=0;if("array"==getType(e))for(var s=this.getConversationList(),o=0;o<e.length;o++)r.forEach(s,function(t){t.getConversationType()==e[o]&&(n+=t.getUnreadMessageCount())});else{if(0==e)return n;var i=this.getConversationList().get(e,t);i&&(n=i.getUnreadMessageCount())}return n},s.prototype.clearMessagesUnreadStatus=function(e,t){if(0==e)return!1;var n=this.getConversationList().get(e,t);return!!(n?n.setUnreadMessageCount(0)||1:0)},s.prototype.initChatRoom=function(e){a.chatroomId=e},s.prototype.joinChatRoom=function(e,t,n){var o=new Modules.ChrmInput;o.setNothing(1),f.queryMsg(19,r.arrayFrom(o.toArrayBuffer()),e,{onSuccess:function(){n.onSuccess(),a.chatroomId=e;var s=new Modules.ChrmPullMsg;0==t&&(t=-1),s.setCount(t),s.setSyncTime(0),f.context.queryMessage("chrmPull",r.arrayFrom(s.toArrayBuffer()),e,1,{onSuccess:function(e){var t=r.int64ToTimestamp(e.syncTime);r.cookieHelper.setItem(a.userId+"CST",t);for(var n=e.list,s=0;s<n.length;s++)f.context.handler.onReceived(n[s])},onError:function(e){n.onError(e)}},"DownStreamMessages")},onError:function(){n.onError(s.callback.ErrorCode.UNKNOWN_ERROR)}},"ChrmOutput")},s.prototype.quitChatRoom=function(e,t){var n=new Modules.ChrmInput;n.setNothing(1),f.queryMsg(17,r.arrayFrom(n.toArrayBuffer()),e,t,"ChrmOutput")},s.prototype.sendNotification=function(e,t,n,r){if(!(n instanceof s.NotificationMessage))throw new Error("Wrong Parameters");this.sendMessage(e,t,new s.MessageContent(n),null,r)},s.prototype.sendStatus=function(e,t,n,r){if(!(n instanceof s.StatusMessage))throw new Error("Wrong Parameters");this.sendMessage(e,t,new s.MessageContent(n),null,r)},s.prototype.setDiscussionInviteStatus=function(e,t,n){var o=new Modules.ModifyPermissionInput;o.setOpenStatus(t.valueOf()),f.queryMsg(11,r.arrayFrom(o.toArrayBuffer()),e,{onSuccess:function(e){n.onSuccess(s.DiscussionInviteStatus.setValue(e))},onError:n.onError})},s.prototype.setDiscussionName=function(e,t,n){var s=new Modules.RenameChannelInput;s.setName(t),f.queryMsg(12,r.arrayFrom(s.toArrayBuffer()),e,n)},s.prototype.removeMemberFromDiscussion=function(e,t,n){var s=new Modules.ChannelEvictionInput;s.setUser(t),f.queryMsg(9,r.arrayFrom(s.toArrayBuffer()),e,n)},s.prototype.createDiscussion=function(e,t,n){var o=new Modules.CreateDiscussionInput;o.setName(e),f.queryMsg(1,r.arrayFrom(o.toArrayBuffer()),a.userId,{onSuccess:function(e){var o=new Modules.ChannelInvitationInput;o.setUsers(t),f.queryMsg(0,r.arrayFrom(o.toArrayBuffer()),e,{onSuccess:function(){},onError:function(){n.onError(s.callback.ErrorCode.UNKNOWN_ERROR)}}),n.onSuccess(e)},onError:function(){n.onError(s.callback.ErrorCode.UNKNOWN_ERROR)}},"CreateDiscussionOutput")},s.prototype.addMemberToDiscussion=function(e,t,n){var s=new Modules.ChannelInvitationInput;s.setUsers(t),f.queryMsg(0,r.arrayFrom(s.toArrayBuffer()),e,n)},s.prototype.getDiscussion=function(e,t){var n=new Modules.ChannelInfoInput;n.setNothing(1),f.queryMsg(4,r.arrayFrom(n.toArrayBuffer()),e,t,"ChannelInfoOutput")},s.prototype.quitDiscussion=function(e,t){var n=new Modules.LeaveChannelInput;n.setNothing(1),f.queryMsg(7,r.arrayFrom(n.toArrayBuffer()),e,t)},s.prototype.quitGroup=function(e,t){var n=new Modules.LeaveChannelInput;n.setNothing(1),f.queryMsg(8,r.arrayFrom(n.toArrayBuffer()),e,t)},s.prototype.joinGroup=function(e,t,n){var s=new Modules.GroupInfo;s.setId(e),s.setName(t);var o=new Modules.GroupInput;o.setGroupInfo([s]),f.queryMsg(6,r.arrayFrom(o.toArrayBuffer()),e,n,"GroupOutput")},s.prototype.syncGroup=function(e,t){for(var n=0,o=[],i=[];n<e.length;n++)if(0===o.length||!new RegExp(e[n].getId()).test(o)){o.push(e[n].getId());var c=new Modules.GroupInfo;c.setId(e[n].getId()),c.setName(e[n].getName()),i.push(c)}var u=new Modules.GroupHashInput;u.setUserId(a.userId),u.setGroupHashCode(MD5(o.sort().join(""))),f.queryMsg(13,r.arrayFrom(u.toArrayBuffer()),a.userId,{onSuccess:function(e){if(1===e){var n=new Modules.GroupInput;n.setGroupInfo(i),f.queryMsg(20,r.arrayFrom(n.toArrayBuffer()),a.userId,{onSuccess:function(){t.onSuccess()},onError:function(){t.onError(s.callback.ErrorCode.UNKNOWN_ERROR)}},"GroupOutput")}else t.onSuccess()},onError:function(){t.onError(s.callback.ErrorCode.UNKNOWN_ERROR)}},"GroupHashOutput")},s.prototype.addToBlacklist=function(e,t){var n=new Modules.Add2BlackListInput;n.setUserId(e),f.queryMsg(21,r.arrayFrom(n.toArrayBuffer()),e,t)},s.prototype.getBlacklist=function(e){var t=new Modules.QueryBlackListInput;t.setNothing(1),f.queryMsg(23,r.arrayFrom(t.toArrayBuffer()),a.userId,e,"QueryBlackListOutput")},s.prototype.getBlacklistStatus=function(e,t){var n=new Modules.BlackListStatusInput;n.setUserId(e),f.queryMsg(24,r.arrayFrom(n.toArrayBuffer()),e,{onSuccess:function(e){t.onSuccess(s.BlacklistStatus.setValue(e))},onError:function(){t.onError(s.callback.ErrorCode.UNKNOWN_ERROR)}})},s.prototype.removeFromBlacklist=function(e,t){var n=new Modules.RemoveFromBlackListInput;n.setUserId(e),f.queryMsg(22,r.arrayFrom(n.toArrayBuffer()),e,t)},s.prototype.getHistoryMessages=function(e,t,n,o){if(0==e.valueOf())return void o.onError(s.callback.ErrorCode.UNKNOWN_ERROR);var i=new Modules.HistoryMessageInput;i.setTargetId(t),i.setDataTime(y.get(e+t)),i.setSize(n),f.queryMsg(M[e.valueOf()],r.arrayFrom(i.toArrayBuffer()),t,{onSuccess:function(n){var s=n.list.reverse();y.set(e+t,r.int64ToTimestamp(n.syncTime));for(var i=0;i<s.length;i++)s[i]=c(s[i]);o.onSuccess(!!n.hasMsg,s)},onError:function(){o.onError(s.callback.ErrorCode.UNKNOWN_ERROR)}},"HistoryMessagesOuput")},e.exports=s},function(e,t){function n(e){var t=function(){};return t.prototype=e,new t}var s=function(e){var t=function(){throw"can't Instantiate Enumerations"};t.setValue=function(e){var n=null;return t.foreach(function(s){(s.value==e||s.name==e)&&(n=t[s.name])},null),n};var s=t.prototype={constructor:t,toString:function(){return this.name},valueOf:function(){return this.value},toJSON:function(){return this.name}};t.values=[];for(var r in e){var o=n(s);o.name=r,o.value=e[r],t[r]=o,t.values.push(o)}return t.foreach=function(e,t){for(var n=0;n<this.values.length;n++)e.call(t,this.values[n])},t};e.exports=s},function(e,t,n){function s(){var e,t,n,s,r,o,i,a,c,u,g,h,f=12,p="RCloud",l=3;switch(arguments.length){case 0:m.call(this,I.CONNECT);break;case 1:m.call(this,arguments[0]);break;case 3:if(m.call(this,I.CONNECT),!arguments[0]||arguments[0].length>64)throw new Error("ConnectMessage:Client Id cannot be null and must be at most 64 characters long: "+arguments[0]);e=arguments[0],r=arguments[1],t=arguments[2]}this.messageLength=function(){var t=d.toMQTString(e).length;return t+=d.toMQTString(o).length,t+=d.toMQTString(i).length,t+=d.toMQTString(n).length,t+=d.toMQTString(s).length,t+f},this.readMessage=function(f){var M=d.parse(f);p=M.readUTF(),l=M.readByte();var y=M.readByte();if(u=(128&y)>0,g=(64&y)>0,c=(32&y)>0,a=y>>3&3,h=(4&y)>0,r=(32&y)>0,t=256*M.read()+M.read(),e=M.readUTF(),h&&(o=M.readUTF(),i=M.readUTF()),u)try{n=M.readUTF()}catch(m){}if(g)try{s=M.readUTF()}catch(m){}return M},this.writeMessage=function(f){var M=d.parse(f);M.writeUTF(p),M.write(l);var y=r?2:0;return y|=h?4:0,y|=a?a>>3:0,y|=c?32:0,y|=g?64:0,y|=u?128:0,M.write(y),M.writeChar(t),M.writeUTF(e),h&&(M.writeUTF(o),M.writeUTF(i)),u&&M.writeUTF(n),g&&M.writeUTF(s),M}}function r(){var e,t,n=2;switch(arguments.length){case 0:m.call(this,I.CONNACK);break;case 1:if(arguments[0]instanceof C)m.call(this,arguments[0]);else if(arguments[0]instanceof T){if(m.call(this,I.CONNACK),null==arguments[0])throw new Error("ConnAckMessage:The status of ConnAskMessage can't be null");e=arguments[0]}}this.messageLength=function(){var e=n;return t&&(e+=d.toMQTString(t).length),e},this.readMessage=function(e,t){var s=d.parse(e);s.read();var r=+s.read();if(!(r>=0&&9>=r))throw new Error("Unsupported CONNACK code:"+r);this.setStatus(r),t>n&&this.setUserId(s.readUTF())},this.writeMessage=function(n){var s=d.parse(n);switch(s.write(128),+e){case 0:case 1:case 2:case 5:case 6:s.write(+e);break;case 3:case 4:s.write(3);break;default:throw new Error("Unsupported CONNACK code:"+e)}return t&&s.writeUTF(t),s},this.getStatus=function(){return e},this.setStatus=function(t){e=t instanceof T?t:T.setValue(t)},this.setUserId=function(e){t=e},this.getUserId=function(){return t}}function o(e){var t;this.MESSAGE_LENGTH=2,e instanceof C?m.call(this,e):(m.call(this,I.DISCONNECT),e instanceof v&&(t=e)),this.messageLength=function(){return this.MESSAGE_LENGTH},this.readMessage=function(e){var t=d.parse(e);t.read();var n=+t.read();if(!(n>=0&&5>=n))throw new Error("Unsupported CONNACK code:"+n);this.setStatus(n)},this.writeMessage=function(e){var n=d.parse(e);if(n.write(0),!(+t>=1&&3>=+t))throw new Error("Unsupported CONNACK code:"+t);n.write(+t-1)},this.setStatus=function(e){t=e instanceof v?e:v.setValue(e)},this.getStatus=function(){return t}}function i(e){e&&e instanceof C?m.call(this,e):m.call(this,I.PINGREQ)}function a(e){e&&e instanceof C?m.call(this,e):m.call(this,I.PINGRESP)}function c(e){var t;m.call(this,e),this.messageLength=function(){return 2},this.writeMessage=function(e){var t=d.parse(e),n=this.getMessageId(),s=255&n,r=(65280&n)>>8;return t.write(r),t.write(s),t},this.readMessage=function(e){var t=d.parse(e),n=256*t.read()+t.read();this.setMessageId(parseInt(n,10))},this.setMessageId=function(e){t=e},this.getMessageId=function(){return t}}function u(e){var t,n=2,s=0;e instanceof C?c.call(this,e):(c.call(this,I.PUBACK),this.setMessageId(e)),this.messageLength=function(){return n},this.writeMessage=function(e){var t=d.parse(e);u.prototype.writeMessage.call(this,t)},this.readMessage=function(e){var n=d.parse(e);u.prototype.readMessage.call(this,n),s=n.readInt(),t=256*n.read()+n.read()},this.setStatus=function(e){t=e},this.getStatus=function(){return t},this.getDate=function(){return s}}function g(e,t,n){var s,r,o,i;1==arguments.length&&e instanceof C?c.call(this,e):3==arguments.length&&(c.call(this,I.PUBLISH),s=e,o=n,r="string"==typeof t?d.toMQTString(t):t),this.messageLength=function(){var e=10;return e+=d.toMQTString(s).length,e+=d.toMQTString(o).length,e+=r.length},this.writeMessage=function(e){var t=d.parse(e);t.writeUTF(s),t.writeUTF(o),g.prototype.writeMessage.apply(this,arguments),t.write(r)},this.readMessage=function(e,t){var n=6,o=d.parse(e);i=o.readInt(),s=o.readUTF(),n+=d.toMQTString(s).length,g.prototype.readMessage.apply(this,arguments),r=new Array(t-n),o.read(r)},this.setTopic=function(e){s=e},this.setData=function(e){r=e},this.setTargetId=function(e){o=e},this.setDate=function(e){i=e},this.setData=function(e){r=e},this.getTopic=function(){return s},this.getData=function(){return r},this.getTargetId=function(){return o},this.getDate=function(){return i}}function h(e,t,n){var s,r,o;e instanceof C?c.call(this,e):3==arguments.length&&(c.call(this,I.QUERY),r="string"==typeof t?d.toMQTString(t):t,s=e,o=n),this.messageLength=function(){var e=0;return e+=d.toMQTString(s).length,e+=d.toMQTString(o).length,e+=2,e+=r.length},this.writeMessage=function(e){var t=d.parse(e);t.writeUTF(s),t.writeUTF(o),this.constructor.prototype.writeMessage.call(this,t),t.write(r)},this.readMessage=function(e,t){var n=0,i=d.parse(e);s=i.readUTF(),o=i.readUTF(),n+=d.toMQTString(s).length,n+=d.toMQTString(o).length,this.constructor.prototype.readMessage.apply(this,arguments),n+=2,r=new Array(t-n),i.read(r)},this.setTopic=function(e){s=e},this.setData=function(e){r=e},this.setTargetId=function(e){o=e},this.getTopic=function(){return s},this.getData=function(){return r},this.getTargetId=function(){return o}}function f(e){e instanceof C?c.call(this,e):(c.call(this,I.QUERYCON),this.setMessageId(e))}function p(e){var t,n,s;c.call(this,e),this.readMessage=function(e,r){var o=d.parse(e);p.prototype.readMessage.call(this,o),s=o.readInt(),n=256*o.read()+o.read(),r>0&&(t=new Array(r-8),o.read(t))},this.getStatus=function(){return n},this.getDate=function(){return s},this.setDate=function(e){s=e},this.setStatus=function(e){n=e},this.setData=function(e){t=e},this.getData=function(){return t}}var l=n(14),d=n(3),M=n(4),y=n(1),m=l.Message,C=l.Header,I=M.Type,T=M.ConnectionState,v=M.DisconnectionStatus;s._name="ConnectMessage",y.inherit(s,m,!0),r._name="ConnAckMessage",y.inherit(r,m,!0),o._name="DisconnectMessage",y.inherit(o,m,!0),i._name="PingReqMessage",y.inherit(i,m,!0),a._name="PingRespMessage",y.inherit(a,m,!0),c._name="RetryableMessage",y.inherit(c,m,!0),u._name="PubAckMessage",y.inherit(u,c,!0),g._name="PublishMessage",y.inherit(g,c,!0),h._name="QueryMessage",y.inherit(h,c,!0),f._name="QueryConMessage",y.inherit(f,c,!0),p._name="QueryAckMessage",y.inherit(p,c,!0),e.exports={ConnectMessage:s,ConnAckMessage:r,DisconnectMessage:o,PingReqMessage:i,PingRespMessage:a,RetryableMessage:c,PubAckMessage:u,PublishMessage:g,QueryMessage:h,QueryConMessage:f,QueryAckMessage:p}},function(e,t,n){function s(e){var t,n,s=0;t=e instanceof r?e:new r(e,!1,a.AT_MOST_ONCE,!1),this.write=function(e){var t=i.parse(e);return n=this.getHeaderFlag(),t.write(n),this.writeMessage(t),t},this.getHeaderFlag=function(){return t.encode()},this.getLengthSize=function(){return s},this.setRetained=function(e){t.retain=e},this.isRetained=function(){return t.retain},this.setQos=function(e){t.qos=e instanceof a?e:a.setValue(e)},this.getQos=function(){return t.qos},this.setDup=function(e){t.dup=e},this.isDup=function(){return t.dup},this.getType=function(){return t.type}}function r(e,t,n,s){this.type=null,this.retain=!1,this.qos=a.AT_LEAST_ONCE,this.dup=!1,e&&+e==e&&1==arguments.length?(this.retain=(1&e)>0,this.qos=a.setValue((6&e)>>1),this.dup=(8&e)>0,this.type=c.setValue(e>>4&15)):(this.type=c.setValue(e),this.retain=t,this.qos=a.setValue(n),this.dup=s)}var o=n(9),i=n(3),a=o.Qos,c=o.Type;s._name="Message",s.prototype={read:function(e,t){this.readMessage(e,t)},toBytes:function(){return this.write([]).getBytesArray()},messageLength:function(){return 0},writeMessage:function(e){},readMessage:function(e){},init:function(e){var t,n;for(n in e)e.hasOwnProperty(n)&&(t=n.replace(/^\w/,function(e){var t=e.charCodeAt(0);return"set"+(t>=97?String.fromCharCode(-33&t):e)}),t in this&&this[t](e[n]))}},r.prototype={getType:function(){return this.type},encode:function(){var e=this.type<<4;return e|=this.retain?1:0,e|=this.qos<<1,e|=this.dup?8:0},toString:function(){return"Header [type="+this.type+",retain="+this.retain+",qos="+this.qos+",dup="+this.dup+"]"}},e.exports={Message:s,Header:r}},function(e,t,n){var s=n(6),r=s({AT_MOST_ONCE:0,AT_LEAST_ONCE:1,EXACTLY_ONCE:2,DEFAULT:3}),o=s({CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,QUERY:5,QUERYACK:6,QUERYCON:7,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14}),i=s({RECONNECT:0,OTHER_DEVICE_LOGIN:1,CLOSURE:2,UNKNOWN_ERROR:3,LOGOUT:4,BLOCK:5}),a=s({ACCEPTED:0,UNACCEPTABLE_PROTOCOL_VERSION:1,IDENTIFIER_REJECTED:2,SERVER_UNAVAILABLE:3,TOKEN_INCORRECT:4,NOT_AUTHORIZED:5,REDIRECT:6,PACKAGE_ERROR:7,APP_BLOCK_OR_DELETE:8,BLOCK:9,TOKEN_EXPIRE:10,DEVICE_ERROR:11});e.exports={Qos:r,Type:o,DisconnectionStatus:i,ConnectionState:a}},function(e,t,n){function s(e,t){switch(t){case"GetUserInfoOutput":var n=new RongIMClient.UserInfo;return n.setUserId(e.userId),n.setUserName(e.userName),n.setPortraitUri(e.userPortrait),n;case"GetQNupTokenOutput":return{deadline:util.int64ToTimestamp(e.deadline),token:e.token};case"GetQNdownloadUrlOutput":return{downloadUrl:e.downloadUrl};case"CreateDiscussionOutput":return e.id;case"ChannelInfoOutput":var s=new RongIMClient.Discussion;return s.setCreatorId(e.adminUserId),s.setId(e.channelId),s.setMemberIdList(e.firstTenUserIds),s.setName(e.channelName),s.setOpen(RongIMClient.DiscussionInviteStatus.setValue(e.openStatus)),s;case"GroupHashOutput":return e.result;
case"QueryBlackListOutput":return e.userIds;default:return e}}function r(e){var t,n=this;this.timeout=null,this.onError=null,e&&"number"==typeof e?t=e:(t=6e3,this.onError=e),this.resumeTimer=function(){t>0&&!this.timeout&&(this.timeout=setTimeout(function(){n.readTimeOut(!0)},t))}}function o(e,t){r.call(this,t),this.done=e||function(){},this.fail=t||function(){}}function i(e,t){r.call(this,t),this.done=e||function(){},this.fail=t||function(){}}function a(e,t,n){r.call(this,t),this.context=n,this.done=e||function(){},this.fail=t||function(){}}var c=n(1),u=n(2),g=n(13);r.prototype={pauseTimer:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},readTimeOut:function(e){e&&this.onError?this.onError(RongIMClient.callback.ErrorCode.TIMEOUT):this.pauseTimer()}},c.inherit(o,r),o.prototype.process=function(e,t,n){this.readTimeOut(),0==e?(n&&n.setSentStatus(RongIMClient.SentStatus.RECEIVED),this.done()):this.fail(RongIMClient.SendErrorStatus.setValue(e))},o.prototype.readTimeOut=function(e){o.super_.prototype.readTimeOut.call(this,e)},c.inherit(i,r),i.prototype.process=function(e,t,n,r){if(this.readTimeOut(),r&&t&&0==e){try{t=s(Modules[r].decode(t),r)}catch(o){return void this.fail(RongIMClient.callback.ErrorCode.UNKNOWN_ERROR)}"GetUserInfoOutput"==r&&(u.userInfoMapping[t.getUserId()]=t),this.done(t)}else e>0?this.fail(e):this.done(e)},i.prototype.readTimeOut=function(e){i.super_.prototype.readTimeOut.call(this,e)},c.inherit(a,r),a.prototype.process=function(e,t){if(this.readTimeOut(),0==e){if(u.userId=this.context.userId=t,RongIMClient.isNotPullMsg||this.context.syncTime(),u.reconnectSet.onSuccess){u.reconnectSet.onSuccess(t);try{delete u.reconnectSet.onSuccess}catch(n){}}else this.done(t);g.getInstance().fire("StatusChanged",0),g.getInstance()._doQueue()}else if(6==e){var s=this;a.redirect(this.context.token,this.context.appId,function(){s.context.clearHeartbeat(),a.redirect(),s.context.channel.socket.fire("StatusChanged",2)},function(){s.fail()},!1)}else u.reconnectSet.onError?(u.reconnectSet.onError(RongIMClient.ConnectErrorStatus.setValue(e)),delete u.reconnectSet.onError):this.fail(RongIMClient.ConnectErrorStatus.setValue(e))},a.prototype.readTimeOut=function(e){a.super_.prototype.readTimeOut.call(this,e)},a.redirect=function(){},e.exports={MessageCallback:r,PublishCallback:o,QueryCallback:i,ConnectAck:a}},function(e,t,n){function s(e){var t,n,s=e.content,i=e.classname;try{n=JSON.parse(RongBinaryHelper.readUTF(s.offset?o.arrayFrom(s.buffer).slice(s.offset,s.limit):s))}catch(a){return null}return"Expression"in RongIMClient&&"RC:TxtMsg"==i&&n.content&&(n.content=n.content.replace(/[\uf000-\uf700]/g,function(e){return RongIMClient.Expression.calcUTF(e)||e})),t=i in r.typeMapping?new RongIMClient[r.typeMapping[i]](n):i in r.sysNtf?new RongIMClient[r.sysNtf[i]](n):i in r.registerMessageTypeMapping?new RongIMClient[r.registerMessageTypeMapping[i]](n):new RongIMClient.UnknownMessage(n,i),t.setSentTime(o.int64ToTimestamp(e.dataTime)),t.setSenderUserId(e.fromUserId),t.setConversationType(RongIMClient.ConversationType.setValue(r.mapping[e.type])),t.setTargetId(/^[234]$/.test(e.type||e.getType())?e.groupId:t.getSenderUserId()),e.fromUserId==r.userId?t.setMessageDirection(RongIMClient.MessageDirection.SEND):t.setMessageDirection(RongIMClient.MessageDirection.RECEIVE),t.setReceivedTime((new Date).getTime()),t.setMessageId(t.getConversationType()+"_"+~~(16777215*Math.random())),t.setReceivedStatus(new RongIMClient.ReceivedStatus),t}var r=n(2),o=n(1);e.exports=s},function(e,t,n){var s=n(1),r=n(20),o=n(2),i=(window,function(e,t){this.base=e,this.options={timeout:3e4},s.merge(this.options,t)});i.prototype.send=function(){throw new Error("No rewrite send() method")},i.prototype.connect=function(){throw new Error("No rewrite connect() method")},i.prototype.disconnect=function(){throw new Error("No rewrite disconnect() method")},i.prototype._encode=function(e){var t="?messageid="+e.getMessageId()+"&header="+e.getHeaderFlag()+"&sessionid="+s.cookieHelper.getItem(o.Endpoint.userId+"sId");return/(PubAckMessage|QueryConMessage)/.test(e.constructor._name)||(t+="&topic="+e.getTopic()+"&targetid="+(e.getTargetId()||"")),{url:t,data:"getData"in e?e.getData():""}},i.prototype._decode=function(e){e&&(s.isArray(e)?this._onMessage(new r.MessageInputStream(e).readMessage()):"ArrayBuffer"===s.getType(e)&&this._onMessage(new r.MessageInputStream(s.arrayFrom(e)).readMessage()))},i.prototype._onData=function(e,t){if(e&&"lost params"!=e){t&&(s.cookieHelper.getItem(o.Endpoint.userId+"sId")||s.cookieHelper.setItem(o.Endpoint.userId+"sId",t));var n=this,i=s.JSON.parse(e);s.isArray(i)||(i=[i]),s.forEach(i,function(e){n._onMessage(new r.MessageInputStream(e,!0).readMessage())})}},i.prototype._onMessage=function(e){this.base._onMessage(e)},i.prototype._onConnect=function(){this.connected=!0,this.connecting=!1,this.base._onConnect()},i.prototype._onDisconnect=function(){this.connecting=!1,this.connected=!1,this.base._onDisconnect()},i.prototype._baseConnect=function(){this.base.connect(null,null)},e.exports=i},function(e,t,n){var s=n(1),r=n(26),o=n(25),i={websocket:r,"xhr-polling":o},a=function(){if(this.options={token:"",transports:["websocket","xhr-polling"]},this.connected=!1,this.connecting=!1,this._events={},this.currentURL="",this.transport=this.getTransport(s.getTransportType()),null===this.transport)throw new Error("the channel was not supported")};a.prototype.getTransport=function(e){var t=0,n=e||this.options.transports[t];return i[n]&&i[n].check()&&i[n].XDomainCheck()?new i[n](this,{}):null},a.prototype.connect=function(e,t){return this.transport&&2==arguments.length&&(e&&this.on("connect",t||function(){}),(this.connecting||this.connected)&&this.disconnect(),this.connecting=!0,e&&(this.currentURL=e),this.transport.connect(this.currentURL)),this},a.prototype.send=function(e){return this.transport&&this.connected?void this.transport.send(e):this._queue(e)},a.prototype.disconnect=function(e){return e&&this.fire("StatusChanged",e),this.transport.disconnect(),this},a.prototype.reconnect=function(){if(this.currentURL)return this.connect(null,null);throw new Error("reconnect:no have URL")},a.prototype.fire=function(e,t){if(e in this._events)for(var n=0,s=this._events[e].length;s>n;n++)this._events[e][n](t);return this},a.prototype.removeEvent=function(e,t){if(e in this._events)for(var n=0,s=this._events[e].length;s>n;n++)this._events[e][n]==t&&this._events[e].splice(n,1);return this},a.prototype._queue=function(e){return"_queueStack"in this||(this._queueStack=[]),this._queueStack.push(e),this},a.prototype._doQueue=function(){if(!("_queueStack"in this&&this._queueStack.length))return this;for(var e=0;e<this._queueStack.length;e++)this.transport.send(this._queueStack[e]);return this._queueStack=[],this},a.prototype._onConnect=function(){this.connected=!0,this.connecting=!1,s.cookieHelper.setItem("rongSDK",s.getTransportType()),this.fire("connect")},a.prototype._onMessage=function(e){this.fire("message",e)},a.prototype._onDisconnect=function(){var e=this.connected;this.connected=!1,this.connecting=!1,this._queueStack=[],e&&this.fire("disconnect")},a.prototype.on=function(e,t){return"function"==typeof t&&e?(e in this._events?-1==s.indexOf(this._events,t)&&this._events[e].push(t):this._events[e]=[t],this):this};var c=function(e,t){var n=new a;return c.getInstance=function(){return n},n.connect(e,t),n};e.exports=c},function(e,t,n){function s(e){var t,n,s=0;t=e instanceof r?e:new r(e,!1,a.AT_MOST_ONCE,!1),this.write=function(e){var t=i.parse(e);return n=this.getHeaderFlag(),t.write(n),this.writeMessage(t),t},this.getHeaderFlag=function(){return t.encode()},this.getLengthSize=function(){return s},this.setRetained=function(e){t.retain=e},this.isRetained=function(){return t.retain},this.setQos=function(e){t.qos=e instanceof a?e:a.setValue(e)},this.getQos=function(){return t.qos},this.setDup=function(e){t.dup=e},this.isDup=function(){return t.dup},this.getType=function(){return t.type}}function r(e,t,n,s){this.type=null,this.retain=!1,this.qos=a.AT_LEAST_ONCE,this.dup=!1,e&&+e==e&&1==arguments.length?(this.retain=(1&e)>0,this.qos=a.setValue((6&e)>>1),this.dup=(8&e)>0,this.type=c.setValue(e>>4&15)):(this.type=c.setValue(e),this.retain=t,this.qos=a.setValue(n),this.dup=s)}var o=n(4),i=n(3),a=o.Qos,c=o.Type;s._name="Message",s.prototype={read:function(e,t){this.readMessage(e,t)},toBytes:function(){return this.write([]).getBytesArray()},messageLength:function(){return 0},writeMessage:function(e){},readMessage:function(e){},init:function(e){var t,n;for(n in e)e.hasOwnProperty(n)&&(t=n.replace(/^\w/,function(e){var t=e.charCodeAt(0);return"set"+(t>=97?String.fromCharCode(-33&t):e)}),t in this&&this[t](e[n]))}},r.prototype={getType:function(){return this.type},encode:function(){var e=this.type<<4;return e|=this.retain?1:0,e|=this.qos<<1,e|=this.dup?8:0},toString:function(){return"Header [type="+this.type+",retain="+this.retain+",qos="+this.qos+",dup="+this.dup+"]"}},e.exports={Message:s,Header:r}},function(e,t,n){var s=n(5),r=n(1),o=n(4),i=n(6),a=o.ConnectionState,c={MessageTag:{ISPERSISTED:"ISPERSISTED",ISCOUNTED:"ISCOUNTED",NONE:"NONE",ISDISPLAYED:"ISDISPLAYED"},ConversationNotificationStatus:["DO_NOT_DISTURB","NOTIFY"],ConversationType:["CHATROOM","CUSTOMER_SERVICE","DISCUSSION","GROUP","PRIVATE","SYSTEM"],SentStatus:["DESTROYED","FAILED","READ","RECEIVED","SENDING","SENT"],DiscussionInviteStatus:["CLOSED","OPENED"],MediaType:["AUDIO","FILE","IMAGE","VIDEO"],MessageDirection:["RECEIVE","SEND"],MessageType:["DiscussionNotificationMessage","TextMessage","ImageMessage","VoiceMessage","RichContentMessage","HandshakeMessage","UnknownMessage","SuspendMessage","LocationMessage","InformationNotificationMessage","ContactNotificationMessage","ProfileNotificationMessage","CommandNotificationMessage"],SendErrorStatus:{REJECTED_BY_BLACKLIST:405,NOT_IN_DISCUSSION:21406,NOT_IN_GROUP:22406,NOT_IN_CHATROOM:23406},BlacklistStatus:["EXIT_BLACK_LIST","NOT_EXIT_BLACK_LIST"],ConnectionStatus:["CONNECTED","CONNECTING","RECONNECT","OTHER_DEVICE_LOGIN","CLOSURE","UNKNOWN_ERROR","LOGOUT","BLOCK"]};r.each(c,function(e,t){var n={};r.isArray(t)?r.forEach(t,function(e,t){n[e]=t}):n=t,s[e]=i(n)}),s.ConnectErrorStatus=a,s.callback=function(e,t){this.onError=t,this.onSuccess=e},s.callback.ErrorCode=i({TIMEOUT:-1,UNKNOWN_ERROR:-2})},function(e,t,n){var s=n(5),r=n(1);s.MessageContent=function(e){if(!(e instanceof s.RongIMMessage))throw new Error("wrong parameter")},s.MessageContent.prototype.getMessage=function(){return f},s.MessageContent.prototype.encode=function(){var e=new Modules.UpStreamMessage;e.setSessionId(0),e.setClassname(f.getObjectName()),e.setContent(r.JSON.stringify(f.getDetail()));var t=e.toArrayBuffer();return"[object ArrayBuffer]"==Object.prototype.toString.call(t)?[].slice.call(new Int8Array(t)):t},s.MessageHandler=function(e){if("function"!=typeof e)throw new Error("MessageHandler:arguments type is error");this.process=e},s.ReceivedStatus=function(e){var t=e||1;this.getFlag=function(){return t},this.isDownload=function(){return 1==t},this.isListened=function(){return 2==t},this.isRead=function(){return 3==t},this.setDownload=function(){t=1},this.setListened=function(){t=2},this.setRead=function(){t=3}},s.UserInfo=function(e,t,n){var s=e,r=t,o=n;this.getUserName=function(){return r},this.getPortraitUri=function(){return o},this.getUserId=function(){return s},this.setUserName=function(e){r=e},this.setPortraitUri=function(e){o=e},this.setUserId=function(e){s=e}},s.Conversation=function(){var e,t,n,o,i,a,c,u,g,h,f,p,l,d,M=this,y=(new Date).getTime(),m=0,C=s.ConversationNotificationStatus.NOTIFY;this.getConversationTitle=function(){return a},this.toJSON=function(){var s={senderUserName:i,lastTime:y,objectName:e,senderUserId:t,receivedTime:n,conversationTitle:a,conversationType:c,latestMessageId:h,sentTime:p,targetId:l,notificationStatus:C};return r.JSON.stringify(s)},this.setReceivedStatus=function(e){o=e},this.getReceivedStatus=function(){return o},this.getConversationType=function(){return c},this.getDraft=function(){return u},this.getLatestMessage=function(){return g},this.getLatestMessageId=function(){return h},this.getNotificationStatus=function(){return C},this.getObjectName=function(){return e},this.getReceivedTime=function(){return n},this.getSenderUserId=function(){return t},this.getSentStatus=function(){return f},this.getSentTime=function(){return p},this.getTargetId=function(){return l},this.getUnreadMessageCount=function(){return m},this.isTop=function(){var e=s.getInstance().getConversationList();return void 0!=e[0]&&e[0].getTargetId()==this.getTargetId()&&e[0].getConversationType()==this.getConversationType()},this.setConversationTitle=function(e){a=e},this.getConversationPortrait=function(){return d},this.setConversationPortrait=function(e){d=e},this.setConversationType=function(e){c=e},this.setDraft=function(e){u=e},this.setSenderUserName=function(e){i=e},this.setLatestMessage=function(e){g=e},this.setLatestMessageId=function(e){h=e},this.setNotificationStatus=function(e){C=e instanceof s.ConversationNotificationStatus?e:s.ConversationNotificationStatus.setValue(e)},this.setObjectName=function(t){e=t},this.setReceivedTime=function(e){y=n=e},this.setSenderUserId=function(e){t=e},this.getLatestTime=function(){return y},this.setSentStatus=function(e){return!!(f=e)},this.setSentTime=function(e){y=p=e},this.setTargetId=function(e){l=e},this.setTop=function(){void 0==M.getTargetId()||this.isTop()||s.getInstance().getConversationList().add(this)},this.setUnreadMessageCount=function(e){m=e}},s.Discussion=function(e,t,n,s,r){var o=e,i=t,a=n,c=s,u=r;this.getCreatorId=function(){return a},this.getId=function(){return o},this.getMemberIdList=function(){return u},this.getName=function(){return i},this.isOpen=function(){return c},this.setCreatorId=function(e){a=e},this.setId=function(e){o=e},this.setMemberIdList=function(e){u=e},this.setName=function(e){i=e},this.setOpen=function(e){c=!!e}},s.Group=function(e,t,n){var s=e,r=t,o=n;this.getId=function(){return s},this.getName=function(){return r},this.getPortraitUri=function(){return o},this.setId=function(e){s=e},this.setName=function(e){r=e},this.setPortraitUri=function(e){o=e}}},function(e,t,n){var s=n(5),r=n(1);s.RongIMMessage=function(e){var t,n,o,i,a,c,u,g,h,f,p="unknown",l=e||{};this.getDetail=function(){return l},this.getMessageTag=function(){return[s.MessageTag.ISPERSISTED,s.MessageTag.ISCOUNTED,s.MessageTag.ISDISPLAYED]},this.getContent=function(){return l.content},this.getConversationType=function(){return n},this.getExtra=function(){return l.extra},this.getMessageDirection=function(){return o},this.getMessageId=function(){return i},this.getObjectName=function(){return a},this.getReceivedStatus=function(){return c},this.getReceivedTime=function(){return t},this.getSenderUserId=function(){return u},this.getSentStatus=function(){return g},this.getTargetId=function(){return f},this.setContent=function(e,t){l[t||"content"]=e},this.setConversationType=function(e){n=e},this.setExtra=function(e){l.extra=e},this.setMessageDirection=function(e){o=e},this.setMessageId=function(e){i=e},this.setObjectName=function(e){a=e},this.setReceivedStatus=function(e){c=e},this.setSenderUserId=function(e){u=e},this.setSentStatus=function(e){return!!(g=e)},this.setSentTime=function(e){h=r.int64ToTimestamp(e)},this.getSentTime=function(){return h},this.setTargetId=function(e){f=e},this.setReceivedTime=function(e){t=e},this.toJSON=function(){var e={receivedTime:t,messageType:p,details:l,conversationType:n,direction:o,messageId:i,objectName:a,senderUserId:u,sendTime:h,targetId:f};return r.JSON.stringify(e)},this.getMessageType=function(){return p},this.setMessageType=function(e){p=e}},s.NotificationMessage=function(e){s.RongIMMessage.call(this,e),this.getMessageTag=function(){return[s.MessageTag.ISPERSISTED,s.MessageTag.ISDISPLAYED]}},r.inherit(s.NotificationMessage,s.RongIMMessage,!0),s.StatusMessage=function(e){s.RongIMMessage.call(this,e),this.getMessageTag=function(){return["NONE"]}},r.inherit(s.StatusMessage,s.RongIMMessage,!0),s.TextMessage=function(e){s.RongIMMessage.call(this,e),this.setMessageType(s.MessageType.TextMessage),this.setObjectName("RC:TxtMsg")},s.TextMessage.obtain=function(e){return new s.TextMessage({content:e,extra:""})},r.inherit(s.TextMessage,s.RongIMMessage,!0),s.ImageMessage=function(e){s.RongIMMessage.call(this,e),this.setMessageType(s.MessageType.ImageMessage),this.setObjectName("RC:ImgMsg"),this.setImageUri=function(e){this.setContent(e,"imageUri")},this.getImageUri=function(){return this.getDetail().imageUri}},s.ImageMessage.obtain=function(e,t){return new s.ImageMessage({content:e,imageUri:t,extra:""})},r.inherit(s.ImageMessage,s.RongIMMessage,!0),s.RichContentMessage=function(e){s.RongIMMessage.call(this,e),this.setMessageType(s.MessageType.RichContentMessage),this.setObjectName("RC:ImgTextMsg"),this.setTitle=function(e){this.setContent(e,"title")},this.getTitle=function(){return this.getDetail().title},this.setImageUri=function(e){this.setContent(e,"imageUri")},this.getImageUri=function(){return this.getDetail().imageUri}},s.RichContentMessage.obtain=function(e,t,n){return new s.RichContentMessage({title:e,content:t,imageUri:n,extra:""})},r.inherit(s.RichContentMessage,s.RongIMMessage,!0),s.VoiceMessage=function(e){s.RongIMMessage.call(this,e),this.setObjectName("RC:VcMsg"),this.setMessageType(s.MessageType.VoiceMessage),this.setDuration=function(e){this.setContent(e,"duration")},this.getDuration=function(){return this.getDetail().duration}},s.VoiceMessage.obtain=function(e,t){return new s.VoiceMessage({content:e,duration:t,extra:""})},r.inherit(s.VoiceMessage,s.RongIMMessage,!0),s.HandshakeMessage=function(){s.RongIMMessage.call(this),this.setMessageType(s.MessageType.HandshakeMessage),this.setObjectName("RC:HsMsg")},r.inherit(s.HandshakeMessage,s.RongIMMessage,!0),s.SuspendMessage=function(){s.RongIMMessage.call(this),this.setMessageType(s.MessageType.SuspendMessage),this.setObjectName("RC:SpMsg")},r.inherit(s.SuspendMessage,s.RongIMMessage,!0),s.UnknownMessage=function(e,t){s.RongIMMessage.call(this,e),this.setMessageType(s.MessageType.UnknownMessage),this.setObjectName(t)},r.inherit(s.UnknownMessage,s.RongIMMessage,!0),s.LocationMessage=function(e){s.RongIMMessage.call(this,e),this.setMessageType(s.MessageType.LocationMessage),this.setObjectName("RC:LBSMsg"),this.setLatitude=function(e){this.setContent(e,"latitude")},this.getLatitude=function(){return this.getDetail().latitude},this.setLongitude=function(e){this.setContent(e,"longitude")},this.getLongitude=function(){return this.getDetail().longitude},this.setPoi=function(e){this.setContent(e,"poi")},this.getPoi=function(){return this.getDetail().poi}},s.LocationMessage.obtain=function(e,t,n,r){return new s.LocationMessage({content:e,latitude:t,longitude:n,poi:r,extra:""})},r.inherit(s.LocationMessage,s.RongIMMessage,!0),s.DiscussionNotificationMessage=function(e){s.NotificationMessage.call(this,e),this.setMessageType(s.MessageType.DiscussionNotificationMessage),this.setObjectName("RC:DizNtf");var t=!1;this.getExtension=function(){return this.getDetail().extension},this.getOperator=function(){return this.getDetail().operator},this.getType=function(){return this.getDetail().type},this.isHasReceived=function(){return t},this.setExtension=function(e){this.setContent(e,"extension")},this.setHasReceived=function(e){t=!!e},this.setOperator=function(e){this.setContent(e,"operator")},this.setType=function(e){this.setContent(e,"type")}},r.inherit(s.DiscussionNotificationMessage,s.NotificationMessage,!0),s.InformationNotificationMessage=function(e){s.NotificationMessage.call(this,e),this.setMessageType(s.MessageType.InformationNotificationMessage),this.setObjectName("RC:InfoNtf")},s.InformationNotificationMessage.obtain=function(e){return new s.InformationNotificationMessage({content:e,extra:""})},r.inherit(s.InformationNotificationMessage,s.NotificationMessage,!0),s.ContactNotificationMessage=function(e){s.NotificationMessage.call(this,e),this.setMessageType(s.MessageType.ContactNotificationMessage),this.setObjectName("RC:ContactNtf"),this.getOperation=function(){return this.getDetail().operation},this.setOperation=function(e){this.setContent(e,"operation")},this.setMessage=function(e){this.setContent(e,"message")},this.getMessage=function(){return this.getDetail().message},this.getSourceUserId=function(){return this.getDetail().sourceUserId},this.setSourceUserId=function(e){this.setContent(e,"sourceUserId")},this.getTargetUserId=function(){return this.getDetail().targetUserId},this.setTargetUserId=function(e){this.setContent(e,"targetUserId")}},s.ContactNotificationMessage.obtain=function(e,t,n,r){return new s.ContactNotificationMessage({operation:e,sourceUserId:t,targetUserId:n,message:r,extra:""})},s.ContactNotificationMessage.CONTACT_OPERATION_ACCEPT_RESPONSE="ContactOperationAcceptResponse",s.ContactNotificationMessage.CONTACT_OPERATION_REJECT_RESPONSE="ContactOperationRejectResponse",s.ContactNotificationMessage.CONTACT_OPERATION_REQUEST="ContactOperationRequest",r.inherit(s.ContactNotificationMessage,s.NotificationMessage,!0),s.ProfileNotificationMessage=function(e){s.NotificationMessage.call(this,e),this.setMessageType(s.MessageType.ProfileNotificationMessage),this.setObjectName("RC:ProfileNtf"),this.getOperation=function(){return this.getDetail().operation},this.setOperation=function(e){this.setContent(e,"operation")},this.getData=function(){return this.getDetail().data},this.setData=function(e){this.setContent(e,"data")}},s.ProfileNotificationMessage.obtain=function(e,t){return new s.ProfileNotificationMessage({operation:e,data:t,extra:""})},r.inherit(s.ProfileNotificationMessage,s.NotificationMessage,!0),s.CommandNotificationMessage=function(e){s.NotificationMessage.call(this,e),this.setMessageType(s.MessageType.CommandNotificationMessage),this.setObjectName("RC:CmdNtf"),this.getData=function(){return this.getDetail().data},this.setData=function(e){this.setContent(e,"data")},this.getName=function(){return this.getDetail().name},this.setName=function(e){this.setContent(e,"name")}},s.CommandNotificationMessage.obtain=function(e,t){return new s.CommandNotificationMessage({name:e,data:t,extra:""})},r.inherit(s.CommandNotificationMessage,s.NotificationMessage,!0)},function(e,t){(function(t){var n=function(){this.add=function(e){for(var t=0;t<this.length;t++)if(this[t].getTargetId()===e.getTargetId()&&0!=t&&this[t].getConversationType()==e.getConversationType())return void this.unshift(this.splice(t,1)[0]);this.unshift(e)},this.get=function(e,t){for(var n=0;n<this.length;n++)if(this[n].getTargetId()==t&&this[n].getConversationType()==e)return this[n];return null}};n.prototype=[];var s={4:1,2:2,3:3,1:5},r=t.sessionStorage||new function(){var e={};this.length=0,this.clear=function(){e={},this.length=0},this.setItem=function(t,n){return!e[t]&&this.length++,e[t]=n,t in e},this.getItem=function(t){return e[t]},this.removeItem=function(t){return t in e?(delete e[t],this.length--,!0):!1}},o=function(e){this.limit=e||10,this.map={},this.keys=[]};o.prototype.set=function(e,t){var n=this.map,s=this.keys;if(!n.hasOwnProperty(e)){if(s.length===this.limit){var r=s.shift();delete n[r]}s.push(e)}n[e]=t},o.prototype.get=function(e){return this.map[e]||0},e.exports={list:n,C2S:s,sessionStore:r,LimitableMap:o}}).call(t,function(){return this}())},function(e,t,n){function s(){var e,t,n,s,r,o,i,a,c,u,g,h,f=12,p="RCloud",l=3;switch(arguments.length){case 0:m.call(this,I.CONNECT);break;case 1:m.call(this,arguments[0]);break;case 3:if(m.call(this,I.CONNECT),!arguments[0]||arguments[0].length>64)throw new Error("ConnectMessage:Client Id cannot be null and must be at most 64 characters long: "+arguments[0]);e=arguments[0],r=arguments[1],t=arguments[2]}this.messageLength=function(){var t=d.toMQTString(e).length;return t+=d.toMQTString(o).length,t+=d.toMQTString(i).length,t+=d.toMQTString(n).length,t+=d.toMQTString(s).length,t+f},this.readMessage=function(f){var M=d.parse(f);p=M.readUTF(),l=M.readByte();var y=M.readByte();if(u=(128&y)>0,g=(64&y)>0,c=(32&y)>0,a=y>>3&3,h=(4&y)>0,r=(32&y)>0,t=256*M.read()+M.read(),e=M.readUTF(),h&&(o=M.readUTF(),i=M.readUTF()),u)try{n=M.readUTF()}catch(m){}if(g)try{s=M.readUTF()}catch(m){}return M},this.writeMessage=function(f){var M=d.parse(f);M.writeUTF(p),M.write(l);var y=r?2:0;return y|=h?4:0,y|=a?a>>3:0,y|=c?32:0,y|=g?64:0,y|=u?128:0,M.write(y),M.writeChar(t),M.writeUTF(e),h&&(M.writeUTF(o),M.writeUTF(i)),u&&M.writeUTF(n),g&&M.writeUTF(s),M}}function r(){var e,t,n=2;switch(arguments.length){case 0:m.call(this,I.CONNACK);break;case 1:if(arguments[0]instanceof C)m.call(this,arguments[0]);else if(arguments[0]instanceof T){if(m.call(this,I.CONNACK),null==arguments[0])throw new Error("ConnAckMessage:The status of ConnAskMessage can't be null");e=arguments[0]}}this.messageLength=function(){var e=n;return t&&(e+=d.toMQTString(t).length),e},this.readMessage=function(e,t){var s=d.parse(e);s.read();var r=+s.read();if(!(r>=0&&9>=r))throw new Error("Unsupported CONNACK code:"+r);this.setStatus(r),t>n&&this.setUserId(s.readUTF())},this.writeMessage=function(n){var s=d.parse(n);switch(s.write(128),+e){case 0:case 1:case 2:case 5:case 6:s.write(+e);break;case 3:case 4:s.write(3);break;default:throw new Error("Unsupported CONNACK code:"+e)}return t&&s.writeUTF(t),s},this.getStatus=function(){return e},this.setStatus=function(t){e=t instanceof T?t:T.setValue(t)},this.setUserId=function(e){t=e},this.getUserId=function(){return t}}function o(e){var t;this.MESSAGE_LENGTH=2,e instanceof C?m.call(this,e):(m.call(this,I.DISCONNECT),e instanceof v&&(t=e)),this.messageLength=function(){return this.MESSAGE_LENGTH},this.readMessage=function(e){var t=d.parse(e);t.read();var n=+t.read();if(!(n>=0&&5>=n))throw new Error("Unsupported CONNACK code:"+n);this.setStatus(n)},this.writeMessage=function(e){var n=d.parse(e);if(n.write(0),!(+t>=1&&3>=+t))throw new Error("Unsupported CONNACK code:"+t);n.write(+t-1)},this.setStatus=function(e){t=e instanceof v?e:v.setValue(e)},this.getStatus=function(){return t}}function i(e){e&&e instanceof C?m.call(this,e):m.call(this,I.PINGREQ)}function a(e){e&&e instanceof C?m.call(this,e):m.call(this,I.PINGRESP)}function c(e){var t;m.call(this,e),this.messageLength=function(){return 2},this.writeMessage=function(e){var t=d.parse(e),n=this.getMessageId(),s=255&n,r=(65280&n)>>8;return t.write(r),t.write(s),t},this.readMessage=function(e){var t=d.parse(e),n=256*t.read()+t.read();this.setMessageId(parseInt(n,10))},this.setMessageId=function(e){t=e},this.getMessageId=function(){return t}}function u(e){var t,n=2,s=0;e instanceof C?c.call(this,e):(c.call(this,I.PUBACK),this.setMessageId(e)),this.messageLength=function(){return n},this.writeMessage=function(e){var t=d.parse(e);u.prototype.writeMessage.call(this,t)},this.readMessage=function(e){var n=d.parse(e);u.prototype.readMessage.call(this,n),s=n.readInt(),t=256*n.read()+n.read()},this.setStatus=function(e){t=e},this.getStatus=function(){return t},this.getDate=function(){return s}}function g(e,t,n){var s,r,o,i;1==arguments.length&&e instanceof C?c.call(this,e):3==arguments.length&&(c.call(this,I.PUBLISH),s=e,o=n,r="string"==typeof t?d.toMQTString(t):t),this.messageLength=function(){var e=10;return e+=d.toMQTString(s).length,e+=d.toMQTString(o).length,e+=r.length},this.writeMessage=function(e){var t=d.parse(e);t.writeUTF(s),t.writeUTF(o),g.prototype.writeMessage.apply(this,arguments),t.write(r)},this.readMessage=function(e,t){var n=6,o=d.parse(e);i=o.readInt(),s=o.readUTF(),n+=d.toMQTString(s).length,g.prototype.readMessage.apply(this,arguments),r=new Array(t-n),o.read(r)},this.setTopic=function(e){s=e},this.setData=function(e){r=e},this.setTargetId=function(e){o=e},this.setDate=function(e){i=e},this.setData=function(e){r=e},this.getTopic=function(){return s},this.getData=function(){return r},this.getTargetId=function(){return o},this.getDate=function(){return i}}function h(e,t,n){var s,r,o;e instanceof C?c.call(this,e):3==arguments.length&&(c.call(this,I.QUERY),r="string"==typeof t?d.toMQTString(t):t,s=e,o=n),this.messageLength=function(){var e=0;return e+=d.toMQTString(s).length,e+=d.toMQTString(o).length,e+=2,e+=r.length},this.writeMessage=function(e){var t=d.parse(e);t.writeUTF(s),t.writeUTF(o),this.constructor.prototype.writeMessage.call(this,t),t.write(r)},this.readMessage=function(e,t){var n=0,i=d.parse(e);s=i.readUTF(),o=i.readUTF(),n+=d.toMQTString(s).length,n+=d.toMQTString(o).length,this.constructor.prototype.readMessage.apply(this,arguments),n+=2,r=new Array(t-n),i.read(r)},this.setTopic=function(e){s=e},this.setData=function(e){r=e},this.setTargetId=function(e){o=e},this.getTopic=function(){return s},this.getData=function(){return r},this.getTargetId=function(){return o}}function f(e){e instanceof C?c.call(this,e):(c.call(this,I.QUERYCON),this.setMessageId(e))}function p(e){var t,n,s;c.call(this,e),this.readMessage=function(e,r){var o=d.parse(e);p.prototype.readMessage.call(this,o),s=o.readInt(),n=256*o.read()+o.read(),r>0&&(t=new Array(r-8),o.read(t))},this.getStatus=function(){return n},this.getDate=function(){return s},this.setDate=function(e){s=e},this.setStatus=function(e){n=e},this.setData=function(e){t=e},this.getData=function(){return t}}var l=n(8),d=n(3),M=n(9),y=n(1),m=l.Message,C=l.Header,I=M.Type,T=M.ConnectionState,v=M.DisconnectionStatus;s._name="ConnectMessage",y.inherit(s,m,!0),r._name="ConnAckMessage",y.inherit(r,m,!0),o._name="DisconnectMessage",y.inherit(o,m,!0),i._name="PingReqMessage",y.inherit(i,m,!0),a._name="PingRespMessage",y.inherit(a,m,!0),c._name="RetryableMessage",y.inherit(c,m,!0),u._name="PubAckMessage",y.inherit(u,c,!0),g._name="PublishMessage",y.inherit(g,c,!0),h._name="QueryMessage",y.inherit(h,c,!0),f._name="QueryConMessage",y.inherit(f,c,!0),p._name="QueryAckMessage",y.inherit(p,c,!0),e.exports={ConnectMessage:s,ConnAckMessage:r,DisconnectMessage:o,PingReqMessage:i,PingRespMessage:a,RetryableMessage:c,PubAckMessage:u,PublishMessage:g,QueryMessage:h,QueryConMessage:f,QueryAckMessage:p}},function(e,t,n){function s(e){var t=o.parse(e);this.writeMessage=function(e){e instanceof i.Message&&e.write(t)}}function r(e,t){var n,s,r=null;if(t)n=e.headerCode;else{var c=o.parse(e);n=c.readByte()}s=new i.Header(n),this.readMessage=function(){switch(+s.getType()){case 2:r=new a.ConnAckMessage(s);break;case 3:r=new a.PublishMessage(s);break;case 4:r=new a.PubAckMessage(s);break;case 5:r=new a.QueryMessage(s);break;case 6:r=new a.QueryAckMessage(s);break;case 7:r=new a.QueryConMessage(s);break;case 9:case 11:case 13:r=new a.PingRespMessage(s);break;case 1:r=new a.ConnectMessage(s);break;case 8:case 10:case 12:r=new a.PingReqMessage(s);break;case 14:r=new a.DisconnectMessage(s);break;default:throw new Error("No support for deserializing "+s.getType()+" messages")}return t?r.init(e):r.read(c,e.length-1),r}}var o=n(3),i=n(8),a=n(19);e.exports={MessageOutputStream:s,MessageInputStream:r}},function(e,t,n){var s=n(2),r=n(23),o=n(4),i=o.Qos,a=function(e,t,n){this.context=r.connect(e,t,n),a.getInstance=function(){return this}};a.prototype.setListener=function(e){"object"==typeof e&&("function"==typeof e.onChanged?s._ConnectionStatusListener=e:"function"==typeof e.onReceived&&(s._ReceiveMessageListener=e))},a.prototype.reConnect=function(e){this.context.channel.reconnect(e)},a.prototype.disConnect=function(){this.context.clearHeartbeat(),this.context.channel.disconnect()},a.prototype.queryMsg=function(e,t,n,r,o){"string"!=typeof e&&(e=s.topic[e]),this.context.queryMessage(e,t,n,i.AT_MOST_ONCE,r,o)},a.prototype.pubMsg=function(e,t,n,r,o){this.context.publishMessage(s.topic[10][e],t,n,r,o)},e.exports=a},function(e,t,n){function s(e,t,n){if(this.context=n,this.socket=i(e.host+"/websocket?appId="+this.context.appId+"&token="+encodeURIComponent(this.context.token)+"&sdkVer="+this.context.sdkVer+"&apiVer="+this.context.apiVer,t),!("onChanged"in r._ConnectionStatusListener))throw new Error("setConnectStatusListener:Parameter format is incorrect");
this.socket.on("StatusChanged",function(e){return e instanceof o.DisconnectionStatus?(r._ConnectionStatusListener.onChanged(RongIMClient.ConnectionStatus.setValue(e+2)),void n.clearHeartbeat()):void r._ConnectionStatusListener.onChanged(RongIMClient.ConnectionStatus.setValue(e))}),this.socket.on("message",this.context.handler.handleMessage);var s=this;this.socket.on("disconnect",function(){s.socket.fire("StatusChanged",4)})}var r=n(2),o=n(4),i=n(13),a=n(1);s.prototype.writeAndFlush=function(e){var t=this;this.isWritable()?this.socket.send(e):this.reconnect({onSuccess:function(){t.socket.send(e)},onError:function(){throw new Error("reconnect fail")}})},s.prototype.reconnect=function(e){a.messageIdHandler.clearMessageId(),this.socket=this.socket.reconnect(),e&&(r.reconnectSet=e)},s.prototype.disconnect=function(e){this.socket.disconnect(e)},s.prototype.isWritable=function(){return this.socket.connected||this.socket.connecting},e.exports=s},function(e,t,n){function s(e,t){this.timeoutMillis=1e5,this.timeout_=0,this.appId=t,this.token=e,this.sdkVer="1.0.0",this.apiVer="1.0.0",this.channel=null,this.handler=null,this.userId="",this.heartbeat=0,this.chatroomId=""}function r(){var e,t,n,o,i=d.shift(),a=s.getInstance();if(i){if(d.state="pending",2!=i.type)e=h.cookieHelper.getItem(a.userId)||0,t=new Modules.SyncRequestMsg,t.setIspolling(!1),n="pullMsg",o=a.userId;else{if(e=h.cookieHelper.getItem(a.userId+"CST")||0,t=new Modules.ChrmPullMsg,t.setCount(0),n="chrmPull",""===a.chatroomId)throw new Error("syncTime:Received messages of chatroom but was not init");o=a.chatroomId}if(i.pulltime<=e)return d.state="complete",void r();t.setSyncTime(e),a.queryMessage(n,h.arrayFrom(t.toArrayBuffer()),o,p.AT_LEAST_ONCE,{onSuccess:function(e){var t=h.int64ToTimestamp(e.syncTime),o=a.userId;"chrmPull"==n&&(o+="CST"),h.cookieHelper.setItem(o,t);for(var i=e.list,c=0;c<i.length;c++)s.getInstance().handler.onReceived(i[c]);d.state="complete",r()},onError:function(){d.state="complete",r()}},"DownStreamMessages")}}var o=n(7),i=n(24),a=n(22),c=n(10),u=n(2),g=n(27),h=n(1),f=n(4),p=f.Qos,l=window;c.ConnectAck.redirect=function(e){s.getInstance().channel=new a(s.Endpoint,e,s.getInstance())},s.prototype.resumeTimer=function(){var e=this;this.timeout_||(this.timeout_=setTimeout(function(){if(e.timeout_){try{e.channel.disconnect()}catch(t){}clearTimeout(e.timeout_),e.timeout_=0,e.channel.reconnect(),e.channel.socket.fire("StatusChanged",5)}},e.timeoutMillis))},s.prototype.pauseTimer=function(){this.timeout_&&(clearTimeout(this.timeout_),this.timeout_=0)},s.prototype.connect=function(e){var t=this;if(u.Endpoint.host){if("websocket"==h.getTransportType()){if(!l.WebSocket)return void e.onError(RongIMClient.ConnectErrorStatus.setValue(1));"loadFlashPolicyFile"in WebSocket&&WebSocket.loadFlashPolicyFile()}this.handler=new i(this),this.handler.setConnectCallback(e),this.channel=new a(u.Endpoint,function(){"websocket"==h.getTransportType()&&t.keepLive()},this),this.channel.socket.fire("StatusChanged",1)}else e.onError(RongIMClient.ConnectErrorStatus.setValue(5))},s.prototype.keepLive=function(){var e=this;this.heartbeat>0&&clearInterval(this.heartbeat),this.heartbeat=setInterval(function(){e.resumeTimer(),e.channel.writeAndFlush(new o.PingReqMessage),console.log("keep live pingReqMessage sending appId "+e.appId)},18e4)},s.prototype.clearHeartbeat=function(){clearInterval(this.heartbeat),this.heartbeat=0,this.pauseTimer()},s.prototype.publishMessage=function(e,t,n,s,r){var i=h.messageIdHandler.messageIdPlus(this.channel.reconnect);if(i){var a=new o.PublishMessage(e,t,n);a.setMessageId(i),s?(a.setQos(p.AT_LEAST_ONCE),this.handler.putCallback(new c.PublishCallback(s.onSuccess,s.onError),a.getMessageId(),r)):a.setQos(p.AT_MOST_ONCE),this.channel.writeAndFlush(a)}},s.prototype.queryMessage=function(e,t,n,s,r,i){if("userInf"==e&&u.userInfoMapping[n])return void r.onSuccess(u.userInfoMapping[n]);var a=h.messageIdHandler.messageIdPlus(this.channel.reconnect);if(a){var g=new o.QueryMessage(e,t,n);g.setMessageId(a),g.setQos(s),this.handler.putCallback(new c.QueryCallback(r.onSuccess,r.onError),g.getMessageId(),i),this.channel.writeAndFlush(g)}},s.prototype.syncTime=function(e,t){d.push({type:e,pulltime:t}),1==d.length&&"complete"==d.state&&r()},s.connect=function(e,t,n){var r=h.cookieHelper.getItem("appId");r&&r!=e&&(h.cookieHelper.clear(),h.cookieHelper.setItem("appId",e));var o=new s(t,e);return s.getInstance=function(){return o},s.getServerEndpoint(t,e,n,!0),o},s.getServerEndpoint=function(e,t,n,r){if(r){var o=g(e).slice(8,16),i=h.cookieHelper.getItem("navi\\w+?"),a=h.cookieHelper.getItem("navi"+o);if(i==a&&null!==a&&h.cookieHelper.getItem("rongSDK")==h.getTransportType()){var c=unescape(i).split(",");return void setTimeout(function(){RongBinaryHelper.__host=u.Endpoint.host=c[0],u.Endpoint.userId=c[1],s.getInstance().connect(n)},500)}}var f={"navUrl-Debug":"http://nav.sunquan.rongcloud.net:9001/","navUrl-Release":"http://nav.cn.rong.io/"};h.jsonp(f["navUrl-Release"]+("xhr-polling"==h.getTransportType()?"cometnavi.js":"navi.js")+"?appId="+t+"&token="+encodeURIComponent(e),"callBack",function(e){s.getInstance().connect(n),RongBinaryHelper.__host=u.Endpoint.host=e.server,u.Endpoint.userId=e.userId;var t=document.cookie.match(new RegExp("(^| )navi\\w+?=([^;]*)(;|$)"));null!==t&&h.cookieHelper.removeItem(t[0].split("=")[0].replace(/^\s/,"")),h.cookieHelper.setItem("navi"+g(s.getInstance().token).slice(8,16),e.server+","+(e.userId||""))},function(){n.onError(RongIMClient.ConnectErrorStatus.setValue(4))})};var d=[];d.state="complete",e.exports=s},function(e,t,n){function s(e){if(!o._ReceiveMessageListener)throw new Error("please set onReceiveMessageListener");u=this,this.context=e,this._map={},this._onReceived=o._ReceiveMessageListener.onReceived,this.connectCallback=null}var r=n(11),o=n(2),i=n(10),a=n(1),c=n(7),u=null;s.prototype.putCallback=function(e,t,n){var s={Callback:e,Message:n};s.Callback.resumeTimer(),this._map[t]=s},s.prototype.setConnectCallback=function(e){e&&(this.connectCallback=new i.ConnectAck(e.onSuccess,e.onError,this.context),this.connectCallback.resumeTimer())},s.prototype.onReceived=function(e){var t;if("PublishMessage"!=e.constructor._name)t=e,a.cookieHelper.setItem(this.context.userId,a.int64ToTimestamp(t.dataTime));else{if("s_ntf"==e.getTopic())return t=Modules.NotifyMsg.decode(e.getData()),void this.context.syncTime(t.type,a.int64ToTimestamp(t.time));if("s_msg"!=e.getTopic())return;t=Modules.DownStreamMessage.decode(e.getData()),a.cookieHelper.setItem(this.context.userId,a.int64ToTimestamp(t.dataTime))}var n=r(t);if(n.getObjectName()in o.sysNtf)return void this._onReceived(n);var s=RongIMClient.getInstance().getConversationList().get(n.getConversationType(),n.getTargetId());s||(s=RongIMClient.getInstance().createConversation(n.getConversationType(),n.getTargetId(),"")),/ISCOUNTED/.test(n.getMessageTag())&&0!=s.getConversationType()&&s.setUnreadMessageCount(s.getUnreadMessageCount()+1),s.setReceivedTime((new Date).getTime()),s.setReceivedStatus(new RongIMClient.ReceivedStatus),s.setSenderUserId(n.getSenderUserId()),s.setObjectName(n.getObjectName()),s.setNotificationStatus(RongIMClient.ConversationNotificationStatus.DO_NOT_DISTURB),s.setLatestMessageId(n.getMessageId()),s.setLatestMessage(n),s.setTop(),this._onReceived(n)},s.prototype.handleMessage=function(e){if(e)switch(e.constructor._name){case"ConnAckMessage":u.connectCallback.process(e.getStatus(),e.getUserId());break;case"PublishMessage":0!=e.getQos()&&u.context.channel.writeAndFlush(new c.PubAckMessage(e.getMessageId())),u.onReceived(e);break;case"QueryAckMessage":0!=e.getQos()&&u.context.channel.writeAndFlush(new c.QueryConMessage(e.getMessageId()));var t=u._map[e.getMessageId()];t&&(t.Callback.process(e.getStatus(),e.getData(),e.getDate(),t.Message),delete u._map[e.getMessageId()]);break;case"PubAckMessage":var n=u._map[e.getMessageId()];n&&(n.Callback.process(e.getStatus()||0,e.getDate(),n.Message),delete u._map[e.getMessageId()]);break;case"PingRespMessage":u.context.pauseTimer();break;case"DisconnectMessage":u.context.channel.disconnect(e.getStatus())}},e.exports=s},function(e,t,n){var s=n(12),r=n(1),o=n(2),i=window,a=new Function,c=function(){if(!("XMLHttpRequest"in i))return!1;var e=new XMLHttpRequest;return void 0!==e.withCredentials}(),u=function(){return"XDomainRequest"in i?new i.XDomainRequest:"XMLHttpRequest"in i&&c?new XMLHttpRequest:!1},g=s.XHR=function(){s.apply(this,arguments)};r.inherit(g,s),g.prototype.connect=function(e){var t=r.cookieHelper.getItem(o.Endpoint.userId+"sId"),n=this;return t?(setTimeout(function(){n.onopen('{"status":0,"userId":"'+o.Endpoint.userId+'","headerCode":32,"messageId":0,"sessionid":"'+t+'"}'),n._onConnect()},500),this):(this._get(e),this)},g.prototype._checkSend=function(e){var t=this._encode(e);this._send(t)},g.prototype.send=function(e){return this._checkSend(e),this},g.prototype._send=function(e){var t=this;this._sendXhr=this._request(o.Endpoint.host+"/websocket"+e.url,"POST"),"onload"in this._sendXhr?(this._sendXhr.onload=function(){this.onload=a,t._onData(this.responseText)},this._sendXhr.onerror=function(){this.onerror=a}):this._sendXhr.onreadystatechange=function(){4==this.readyState&&(this.onreadystatechange=a,/^(202|200)$/.test(this.status)&&t._onData(this.responseText))},this._sendXhr.send(r.JSON.stringify(e.data))},g.prototype.disconnect=function(){return this._onDisconnect(),this},g.prototype._onDisconnect=function(e){this._xhr&&(this._xhr.onreadystatechange=this._xhr.onload=a,this._xhr.abort(),this._xhr=null),this._sendXhr&&(this._sendXhr.onreadystatechange=this._sendXhr.onload=a,this._sendXhr.abort(),this._sendXhr=null),void 0===e&&s.prototype._onDisconnect.call(this)},g.prototype._request=function(e,t,n){var s=u();return n&&(s.multipart=!0),s.open(t||"GET","http://"+e),"POST"==t&&"setRequestHeader"in s&&s.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8"),s},g.check=function(){try{if(u())return!0}catch(e){}return!1},g.XDomainCheck=function(){return g.check()},g.request=u;var h=s["xhr-polling"]=function(){s.XHR.apply(this,arguments)};r.inherit(h,s.XHR),h.prototype.type="xhr-polling",h.prototype.connect=function(e){if(r.ios||r.android){var t=this;r.load(function(){setTimeout(function(){s.XHR.prototype.connect.call(t,e)},10)})}else s.XHR.prototype.connect.call(this,e)},h.prototype.onopen=function(e,t){this._onData(e,t),/"headerCode":-32,/.test(e)||this._get(o.Endpoint.host+"/pullmsg.js?sessionid="+r.cookieHelper.getItem(o.Endpoint.userId+"sId"),!0)};var f={200:function(e,t,n){var s=t.match(/"sessionid":"\S+?(?=")/);e.onopen(t,s?s[0].slice(13):void 0),n||e._onConnect()},400:function(e){r.cookieHelper.removeItem(o.Endpoint.userId+"sId"),e._onDisconnect(!0),e._baseConnect()}};h.prototype._get=function(e,t){var n=this;this._xhr=this._request(e,"GET"),"onload"in this._xhr?(this._xhr.onload=function(){this.onload=a,"lost params"==this.responseText?f[400](n):f[200](n,this.responseText,t)},this._xhr.onerror=function(){n._onDisconnect()}):this._xhr.onreadystatechange=function(){4==this.readyState&&(this.onreadystatechange=a,/^(200|202)$/.test(this.status)?f[200](n,this.responseText,t):/^(400|403)$/.test(this.status)?f[400](n):n._onDisconnect())},this._xhr.send()},h.check=function(){return s.XHR.check()},h.XDomainCheck=function(){return s.XHR.XDomainCheck()},e.exports=h},function(e,t,n){(function(t){var s=n(12),r=n(1),o=n(3),i=n(28),a=n(2),c=s.websocket=function(){s.apply(this,arguments)};r.inherit(c,s),c.prototype.type="websocket",c.prototype.connect=function(e){var t=this;return this.socket=new WebSocket("ws://"+e),this.socket.binaryType="arraybuffer",this.socket.onopen=function(){t._onConnect()},this.socket.onmessage=function(e){"string"==typeof e.data?t._decode(e.data.split(",")):t._decode(e.data)},this.socket.onclose=function(){t._onClose()},this.socket.onerror=function(){if(!a.reconnectSet.onError)throw new Error("network is unavailable or unknown error");a.reconnectSet.onError(RongIMClient.ConnectErrorStatus.setValue(2)),delete a.reconnectSet.onError},this},c.prototype.send=function(e){var n=new o([]),s=new i.MessageOutputStream(n);s.writeMessage(e);var c=n.getBytesArray(!0);if(1==this.socket.readyState)if("Function"!==r.getType(t.Int8Array)||a.globalConf.WEB_SOCKET_FORCE_FLASH)this.socket.send(c+"");else{var u=new Int8Array(c);this.socket.send(u.buffer)}return this},c.prototype.disconnect=function(){return this.socket&&this.socket.close(),this},c.prototype._onClose=function(){return this._onDisconnect(),this},c.check=function(){return"WebSocket"in t&&WebSocket.prototype&&WebSocket.prototype.send&&"undefined"!=typeof WebSocket},c.XDomainCheck=function(){return!0},e.exports=c}).call(t,function(){return this}())},function(e,t){var n=function(e){function t(e){for(var t=0,n="";3>=t;t++)n+="0123456789abcdef".charAt(e>>8*t+4&15)+"0123456789abcdef".charAt(e>>8*t&15);return n}function n(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function s(e,t,s,r,o,i){return e=n(n(t,e),n(r,i)),n(e<<o|e>>>32-o,s)}function r(e,t,n,r,o,i,a){return s(t&n|~t&r,e,t,o,i,a)}function o(e,t,n,r,o,i,a){return s(t&r|n&~r,e,t,o,i,a)}function i(e,t,n,r,o,i,a){return s(n^(t|~r),e,t,o,i,a)}e=function(e){for(var t=(e.length+8>>6)+1,n=Array(16*t),s=0;16*t>s;s++)n[s]=0;for(s=0;s<e.length;s++)n[s>>2]|=e.charCodeAt(s)<<s%4*8;return n[s>>2]|=128<<s%4*8,n[16*t-2]=8*e.length,n}(e);for(var a=1732584193,c=-271733879,u=-1732584194,g=271733878,h=0;h<e.length;h+=16)var f=a,p=c,l=u,d=g,a=r(a,c,u,g,e[h+0],7,-680876936),g=r(g,a,c,u,e[h+1],12,-389564586),u=r(u,g,a,c,e[h+2],17,606105819),c=r(c,u,g,a,e[h+3],22,-1044525330),a=r(a,c,u,g,e[h+4],7,-176418897),g=r(g,a,c,u,e[h+5],12,1200080426),u=r(u,g,a,c,e[h+6],17,-1473231341),c=r(c,u,g,a,e[h+7],22,-45705983),a=r(a,c,u,g,e[h+8],7,1770035416),g=r(g,a,c,u,e[h+9],12,-1958414417),u=r(u,g,a,c,e[h+10],17,-42063),c=r(c,u,g,a,e[h+11],22,-1990404162),a=r(a,c,u,g,e[h+12],7,1804603682),g=r(g,a,c,u,e[h+13],12,-40341101),u=r(u,g,a,c,e[h+14],17,-1502002290),c=r(c,u,g,a,e[h+15],22,1236535329),a=o(a,c,u,g,e[h+1],5,-165796510),g=o(g,a,c,u,e[h+6],9,-1069501632),u=o(u,g,a,c,e[h+11],14,643717713),c=o(c,u,g,a,e[h+0],20,-373897302),a=o(a,c,u,g,e[h+5],5,-701558691),g=o(g,a,c,u,e[h+10],9,38016083),u=o(u,g,a,c,e[h+15],14,-660478335),c=o(c,u,g,a,e[h+4],20,-405537848),a=o(a,c,u,g,e[h+9],5,568446438),g=o(g,a,c,u,e[h+14],9,-1019803690),u=o(u,g,a,c,e[h+3],14,-187363961),c=o(c,u,g,a,e[h+8],20,1163531501),a=o(a,c,u,g,e[h+13],5,-1444681467),g=o(g,a,c,u,e[h+2],9,-51403784),u=o(u,g,a,c,e[h+7],14,1735328473),c=o(c,u,g,a,e[h+12],20,-1926607734),a=s(c^u^g,a,c,e[h+5],4,-378558),g=s(a^c^u,g,a,e[h+8],11,-2022574463),u=s(g^a^c,u,g,e[h+11],16,1839030562),c=s(u^g^a,c,u,e[h+14],23,-35309556),a=s(c^u^g,a,c,e[h+1],4,-1530992060),g=s(a^c^u,g,a,e[h+4],11,1272893353),u=s(g^a^c,u,g,e[h+7],16,-155497632),c=s(u^g^a,c,u,e[h+10],23,-1094730640),a=s(c^u^g,a,c,e[h+13],4,681279174),g=s(a^c^u,g,a,e[h+0],11,-358537222),u=s(g^a^c,u,g,e[h+3],16,-722521979),c=s(u^g^a,c,u,e[h+6],23,76029189),a=s(c^u^g,a,c,e[h+9],4,-640364487),g=s(a^c^u,g,a,e[h+12],11,-421815835),u=s(g^a^c,u,g,e[h+15],16,530742520),c=s(u^g^a,c,u,e[h+2],23,-995338651),a=i(a,c,u,g,e[h+0],6,-198630844),g=i(g,a,c,u,e[h+7],10,1126891415),u=i(u,g,a,c,e[h+14],15,-1416354905),c=i(c,u,g,a,e[h+5],21,-57434055),a=i(a,c,u,g,e[h+12],6,1700485571),g=i(g,a,c,u,e[h+3],10,-1894986606),u=i(u,g,a,c,e[h+10],15,-1051523),c=i(c,u,g,a,e[h+1],21,-2054922799),a=i(a,c,u,g,e[h+8],6,1873313359),g=i(g,a,c,u,e[h+15],10,-30611744),u=i(u,g,a,c,e[h+6],15,-1560198380),c=i(c,u,g,a,e[h+13],21,1309151649),a=i(a,c,u,g,e[h+4],6,-145523070),g=i(g,a,c,u,e[h+11],10,-1120210379),u=i(u,g,a,c,e[h+2],15,718787259),c=i(c,u,g,a,e[h+9],21,-343485551),a=n(a,f),c=n(c,p),u=n(u,l),g=n(g,d);return t(a)+t(c)+t(u)+t(g)};e.exports=n},function(e,t,n){function s(e){var t=o.parse(e);this.writeMessage=function(e){e instanceof i.Message&&e.write(t)}}function r(e,t){var n,s,r=null;if(t)n=e.headerCode;else{var c=o.parse(e);n=c.readByte()}s=new i.Header(n),this.readMessage=function(){switch(+s.getType()){case 2:r=new a.ConnAckMessage(s);break;case 3:r=new a.PublishMessage(s);break;case 4:r=new a.PubAckMessage(s);break;case 5:r=new a.QueryMessage(s);break;case 6:r=new a.QueryAckMessage(s);break;case 7:r=new a.QueryConMessage(s);break;case 9:case 11:case 13:r=new a.PingRespMessage(s);break;case 1:r=new a.ConnectMessage(s);break;case 8:case 10:case 12:r=new a.PingReqMessage(s);break;case 14:r=new a.DisconnectMessage(s);break;default:throw new Error("No support for deserializing "+s.getType()+" messages")}return t?r.init(e):r.read(c,e.length-1),r}}var o=n(3),i=n(14),a=n(7);e.exports={MessageOutputStream:s,MessageInputStream:r}},function(e,t,n){var s=window,r=n(1),o=n(2),i={canFlashWidget:function(){if("navigator"in s&&"plugins"in navigator&&navigator.plugins["Shockwave Flash"])return!!navigator.plugins["Shockwave Flash"].description;if("ActiveXObject"in s)try{return!!new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e){}return!1}(),supportedWebSocket:function(){return"WebSocket"in s&&"ArrayBuffer"in s&&3===WebSocket.prototype.CLOSED&&!o.globalConf.WEB_SOCKET_FORCE_FLASH&&!o.globalConf.WEB_XHR_POLLING},supportedFlash:function(){return!/opera/i.test(navigator.userAgent)&&!o.globalConf.WEB_XHR_POLLING&&this.canFlashWidget}};r.ready(function(){var e="";r.setTransportType("websocket"),i.supportedWebSocket()?e="http://res.websdk.rongcloud.cn/protobuf-0.2.min.js":i.supportedFlash()?e="http://res.websdk.rongcloud.cn/swfobject-0.2.min.js":(r.setTransportType("xhr-polling"),e="http://res.websdk.rongcloud.cn/xhrpolling-0.2.min.js"),r.loadScript(e)})}]);